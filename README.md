## CDR Service  

### üìå –û–ø–∏—Å–∞–Ω–∏–µ  
–≠—Ç–æ—Ç –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —ç–º—É–ª–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ –∑–≤–æ–Ω–∫–∞—Ö –º–æ–±–∏–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤. –û–Ω:  
‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç CDR-–∑–∞–ø–∏—Å–∏ (Call Detail Record) –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö **H2**.  
‚úÖ –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å UDR-–æ—Ç—á–µ—Ç—ã (Usage Detail Record) —á–µ—Ä–µ–∑ REST API.  
‚úÖ –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –ø–æ –∫–∞–∂–¥–æ–º—É –∞–±–æ–Ω–µ–Ω—Ç—É.  

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –±–∏–ª–ª–∏–Ω–≥–∞ —Å–æ—Ç–æ–≤–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞.  

---

### üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏  
- **Java 17**  
- **Spring Boot 3** (Spring Web, Spring Data JPA)  
- **H2 Database** (–≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è in-memory –ë–î)  
- **Maven** (—Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞)  

---

### üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞  

```
üì¶ src/main/java/com/nexign/cdrservice
 ‚î£ üìÇ Controller
 ‚îÉ ‚îó üìú UdrController.java   # REST-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è UDR
 ‚î£ üìÇ Entity
 ‚îÉ ‚îó üìú CdrEntity.java       # JPA-—Å—É—â–Ω–æ—Å—Ç—å CDR-–∑–∞–ø–∏—Å–∏
 ‚î£ üìÇ Repository
 ‚îÉ ‚îó üìú CdrRepository.java   # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
 ‚î£ üìÇ Service
 ‚îÉ ‚îó üìú CdrService.java      # –õ–æ–≥–∏–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ CDR
 ‚îó üìú CdrServiceApplication.java # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```

---

### üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö  

#### **CDR (Call Detail Record) ‚Äî –∑–∞–ø–∏—Å—å –æ –∑–≤–æ–Ω–∫–µ**  
| –ü–æ–ª–µ       | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö      | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|---------------|----------|
| `id`       | Long          | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞–ø–∏—Å–∏ |
| `callType` | String        | "01" ‚Äî –∏—Å—Ö–æ–¥—è—â–∏–π, "02" ‚Äî –≤—Ö–æ–¥—è—â–∏–π |
| `caller`   | String        | –ù–æ–º–µ—Ä –∑–≤–æ–Ω—è—â–µ–≥–æ –∞–±–æ–Ω–µ–Ω—Ç–∞ |
| `receiver` | String        | –ù–æ–º–µ—Ä –ø—Ä–∏–Ω–∏–º–∞—é—â–µ–≥–æ –∞–±–æ–Ω–µ–Ω—Ç–∞ |
| `startTime`| LocalDateTime | –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –∑–≤–æ–Ω–∫–∞ |
| `endTime`  | LocalDateTime | –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –∑–≤–æ–Ω–∫–∞ |

–ü—Ä–∏–º–µ—Ä **CDR-–æ—Ç—á–µ—Ç–∞ (CSV —Ñ–æ—Ä–º–∞—Ç)**:  
```
02,79876543221,79123456789,2025-02-10T14:56:12,2025-02-10T14:58:20
01,79996667755,79876543221,2025-02-10T10:12:25,2025-02-10T10:12:57
```

#### **UDR (Usage Detail Record) ‚Äî –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç**  
–ü—Ä–∏–º–µ—Ä JSON-–æ—Ç—á–µ—Ç–∞:  
```json
{
    "msisdn": "79992221122",
    "incomingCall": {
        "totalTime": "02:12:13"
    },
    "outcomingCall": {
        "totalTime": "00:02:50"
    }
}
```

---

### üì° API  

#### ‚úÖ **1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è CDR-–∑–∞–ø–∏—Å–µ–π**  
–°–æ–∑–¥–∞—ë—Ç N —Å–ª—É—á–∞–π–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –æ –∑–≤–æ–Ω–∫–∞—Ö –≤ –ë–î.  
üìå **POST** `/api/udr/generate?count=1000`  
üí° **–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞**:  
```
–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ 1000 CDR-–∑–∞–ø–∏—Å–µ–π.
```

#### ‚úÖ **2. –ü–æ–ª—É—á–µ–Ω–∏–µ UDR –ø–æ –∞–±–æ–Ω–µ–Ω—Ç—É**  
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç UDR-–æ—Ç—á–µ—Ç –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –Ω–æ–º–µ—Ä—É.  
üìå **GET** `/api/udr/{msisdn}?month=2025-02`  
üí° **–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞**:  
```json
{
    "msisdn": "79991112233",
    "incomingCall": { "totalTime": "01:45:30" },
    "outcomingCall": { "totalTime": "00:23:15" }
}
```

#### ‚úÖ **3. –ü–æ–ª—É—á–µ–Ω–∏–µ UDR –¥–ª—è –≤—Å–µ—Ö –∞–±–æ–Ω–µ–Ω—Ç–æ–≤**  
üìå **GET** `/api/udr/all?month=2025-02`  
üí° **–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞**:  
```json
[
    {
        "msisdn": "79991112233",
        "incomingCall": { "totalTime": "01:45:30" },
        "outcomingCall": { "totalTime": "00:23:15" }
    },
    {
        "msisdn": "79887766554",
        "incomingCall": { "totalTime": "00:50:10" },
        "outcomingCall": { "totalTime": "00:10:05" }
    }
]
```
